# 值班管理系统测试用例

## 1. SQL语法错误修复测试
**测试用例编号**：TC001
**测试目标**：验证数据库表结构正确，不存在"Unknown column 'schedule_mode_id' in 'field list'"错误
**测试步骤**：
1. 执行`hyper_duty_ddl.sql`脚本创建数据库表
2. 执行`hyper_duty_dml.sql`脚本插入初始数据
3. 执行查询：`SELECT id,schedule_name,description,start_date,end_date,schedule_mode_id,status,create_by,create_time,update_time FROM duty_schedule`
**预期结果**：查询成功执行，返回值班表数据

## 2. 排班模式列表显示测试
**测试用例编号**：TC002
**测试目标**：验证DutyAssignment.vue组件中排班模式列表正确显示
**测试步骤**：
1. 启动前端应用
2. 登录系统
3. 进入值班安排页面
4. 点击批量排班按钮
5. 选择"排班模式"选项
**预期结果**：
- 排班模式下拉框显示可用的排班模式列表
- 每个排班模式显示名称和描述
- 暂无排班模式时显示警告提示

## 3. 排班模式API访问测试
**测试用例编号**：TC003
**测试目标**：验证排班模式API接口正常工作
**测试步骤**：
1. 启动后端服务
2. 发送GET请求到`/duty/schedule-mode/list`
**预期结果**：返回状态码200，包含启用的排班模式列表

## 4. 请假审批检查排班功能测试
**测试用例编号**：TC004
**测试目标**：验证请假审批页面的检查排班功能正常工作
**测试步骤**：
1. 启动前端应用
2. 登录系统
3. 进入请假审批页面
4. 选择一条待审批记录
5. 点击审批按钮
6. 选择"检查排班"选项
7. 点击确定
**预期结果**：
- 显示检查结果
- 正确提示是否有冲突的排班

## 5. 操作日志记录测试
**测试用例编号**：TC005
**测试目标**：验证操作日志自动记录功能正常工作
**测试步骤**：
1. 启动后端服务
2. 登录系统
3. 执行一系列操作（如查看值班表、创建值班安排等）
4. 查询operation_log表
**预期结果**：
- 每条操作都被记录到日志表中
- 包含操作人、操作类型、操作模块等信息
- JWT解析失败时使用默认值

## 6. 自动排班API测试
**测试用例编号**：TC006
**测试目标**：验证根据排班模式生成排班的API正常工作
**测试步骤**：
1. 启动后端服务
2. 发送POST请求到`/duty/auto-schedule/generate-by-mode`
3. 请求体包含必要参数：scheduleId, startDate, endDate, modeId, configParams
**预期结果**：返回状态码200，包含生成的排班安排列表

## 7. 批量排班功能测试
**测试用例编号**：TC007
**测试目标**：验证批量排班功能正常工作
**测试步骤**：
1. 启动前端应用
2. 登录系统
3. 进入值班安排页面
4. 选择值班表
5. 点击批量排班按钮
6. 选择日期范围和排班方式
7. 点击确定
**预期结果**：
- 成功生成排班安排
- 日历上显示新生成的排班
- 显示成功提示信息

## 8. 排班模式与算法关联测试
**测试用例编号**：TC008
**测试目标**：验证排班模式与排班算法正确关联
**测试步骤**：
1. 检查hyper_duty_dml.sql中排班模式的algorithm_class字段
2. 验证该字段指向正确的算法实现类
3. 执行自动排班操作
**预期结果**：
- 排班模式正确关联到对应的算法
- 算法正常执行生成排班

## 9. 请假审批流程测试
**测试用例编号**：TC009
**测试目标**：验证完整的请假审批流程
**测试步骤**：
1. 启动前端应用
2. 登录系统
3. 进入请假审批页面
4. 选择一条待审批记录
5. 填写审批意见
6. 选择审批结果
7. 点击确定
**预期结果**：
- 审批状态更新
- 显示成功提示
- 自动处理排班（如果选择）

## 10. JWT认证测试
**测试用例编号**：TC010
**测试目标**：验证JWT认证机制正常工作
**测试步骤**：
1. 启动后端服务
2. 发送请求到需要认证的API接口
3. 携带无效或过期的JWT令牌
4. 携带有效JWT令牌
**预期结果**：
- 无效令牌返回401状态码
- 有效令牌正常访问API
- 操作日志正确记录操作人信息
